# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略

_数据获取和预处理：
使用numpy.loadtxt加载太阳黑子数据文件，指定usecols参数只读取年份、月份和太阳黑子数列，避免列数不一致问题，将年份和月份合并为小数年份表示

傅里叶变换实现：
使用numpy.fft.fft对太阳黑子数据进行快速傅里叶变换，在变换前去除数据均值以消除直流分量

功率谱计算：
计算傅里叶系数的模平方|FFT|²作为功率谱，将功率谱归一化处理，使用numpy.fft.fftfreq生成对应的频率数组

周期检测策略：
在功率谱中寻找最大峰值对应的频率，计算周期T=1/f，并转换为年单位，忽略高频噪声部分，只分析低频段_

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

请在此处粘贴您生成的太阳黑子数量随时间变化的图像，并简要说明您从图中观察到的周期性特征。

_![1](https://github.com/user-attachments/assets/aca76b98-274f-4a2e-871d-44315c4d1c51)
_

图像说明：
_从时间序列图中可以观察到太阳黑子数量呈现明显的周期性波动，大约每10-11年出现一次高峰。波动幅度在不同周期中有所变化，但周期性特征非常显著。_

### 3.2 功率谱分析

请在此处粘贴您生成的功率谱图像，并标明主要峰值对应的周期。

_![2](https://github.com/user-attachments/assets/f28eb5c7-8575-4a00-9756-d53b6c0b2427)
_

图像说明：
_功率谱图显示在周期约132个月(11年)处有一个显著峰值，这与已知的太阳黑子11年周期相符。_

### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 |   132    |   11.0   |
| 傅里叶分析 | 132.64  |  11.05   |

两种方法的相对误差：_0.48%_

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
- 太阳黑子周期与太阳磁场活动有什么关系？
- 太阳黑子活动对地球气候、通信系统等有何影响？

_太阳黑子是太阳表面温度较低的区域，由强磁场抑制对流形成；其周期性变化与太阳磁场的22年周期密切相关（11年为半周期），太阳黑子活动会干扰无线电通信，增加航天器受到辐射的风险，极光现象在黑子活动高峰期更频繁_

### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

_优点：能精确量化周期性成分，可同时检测多个周期，计算效率高；
局限性：要求数据等间隔，对非平稳信号效果不佳，无法定位周期发生时间
其他方法如小波变换可以分析时变周期，但计算更复杂。_

### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

_长期趋势会污染低频成分，应在傅里叶变换前去除。常用方法是先拟合线性趋势并减去。_

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

_使用更短时间窗口会降低频率分辨率，可能导致周期检测不准确。但能反映周期性的时变特征。_

## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

_本实验通过傅里叶变换成功检测出太阳黑子的11年周期，验证了该方法的有效性。同时认识到太阳活动对地球环境的重要影响。傅里叶变换是分析周期性信号的强大工具，但需注意其适用条件和局限性。_

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
    # 使用usecols明确指定要读取的列，避免列数不一致的问题
    # 假设数据格式为：年份 月份 年月小数 太阳黑子数 标准差 观测数 [可能的额外列]
    data = np.loadtxt(url, usecols=(0, 1, 3))  # 只读取第0(年份)、1(月份)、3(太阳黑子数)列
    years = data[:, 0] + (data[:, 1] - 1)/12.0  # 将年份转换为小数形式
    sunspots = data[:, 2]  # 第3列是太阳黑子数
    return years, sunspots

def compute_power_spectrum(sunspots):
    N = len(sunspots)
    # 去除均值消除直流分量
    sunspots = sunspots - np.mean(sunspots)
    # 执行FFT
    fft_result = np.fft.fft(sunspots)
    # 计算功率谱
    power = np.abs(fft_result)**2 / N
    # 生成频率数组
    frequencies = np.fft.fftfreq(N, d=1)
    return frequencies[frequencies>0], power[frequencies>0]

def find_main_period(frequencies, power):
    # 忽略高频噪声
    mask = (frequencies > 0) & (frequencies < 0.1)
    power = power[mask]
    freqs = frequencies[mask]
    # 找到主峰值
    main_freq = freqs[np.argmax(power)]
    return 1/main_freq
```

代码说明：
_compute_power_spectrum实现标准化的功率谱计算；
find_main_period通过限制频率范围提高周期检测准确性；
使用numpy.fft模块高效完成核心计算。_
